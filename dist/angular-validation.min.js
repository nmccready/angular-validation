(function(){angular.module("validation",["validation.utils","validation.provider","validation.directive"]),angular.module("validation.directive",["validation.utils","validation.provider"]),angular.module("validation.provider",["validation.utils"]),angular.module("validation.utils",[])}).call(this),function(){angular.module("validation.utils").service("validationPromiseUtils",["$q",function(a){function b(a){return a.constructor===Object&&"function"==typeof a.then}function c(b,c){var d=a.defer();return d[c](b),d.promise}function d(a){return c(a,"resolve")}function e(a){return c(a,"reject")}function f(b){return a.when(b)}return{resolve:d,reject:e,toPromise:f,isPromise:b}}])}.call(this),function(){function a(){var a,b,c,d,e,f,g=this,h=function(g){a=g,b=a.get("$rootScope"),c=a.get("$http"),d=a.get("$q"),e=a.get("$timeout"),f=a.get("$log")},i={},j=null,k={};this.setExpression=function(a){return angular.extend(i,a),g},this.getExpression=function(a){return i[a]},this.setDefaultMsg=function(a){return angular.extend(k,a),g},this.getDefaultMsg=function(a){return k[a]},this.setValidMethod=function(a){j=a},this.getValidMethod=function(){return j},this.setErrorHTML=function(a){return a.constructor===Function?(g.getErrorHTML=a,g):void 0},this.getErrorHTML=function(a){return'<p class="validation-invalid">'+a+"</p>"},this.setSuccessHTML=function(a){return a.constructor===Function?(g.getSuccessHTML=a,g):void 0},this.getSuccessHTML=function(a){return'<p class="validation-valid">'+a+"</p>"},this.showSuccessMessage=!0,this.showErrorMessage=!0,this.checkValid=function(a){return!(!a||!a.$valid)},this.validate=function(a){function b(a){a&&h.push(a(e++))}var c=d.defer(),e=0,h=[];if(void 0===a)return f.error("This is not a regular Form name scope"),c.reject("This is not a regular Form name scope"),c.promise;if(a.validationId)a.$angularValidators&&b(a.$angularValidators[a.$name+"-"+a.validationId]);else if(a.constructor===Array)for(var i in a)a[i].$angularValidators&&b(a[i].$angularValidators[a[i].$name+"-"+a[i].validationId]);else for(var j in a)if("$"!==j[0]&&a[j].hasOwnProperty("$dirty")){if(!a[j].$angularValidators)continue;b(a[j].$angularValidators[j+"-"+a[j].validationId])}return c.promise.success=function(a){return c.promise.then(function(b){a(b)}),c.promise},c.promise.error=function(a){return c.promise.then(null,function(b){a(b)}),c.promise},d.all(h).then(function(){g.checkValid(a)?c.resolve("success"):c.reject("error")}),c.promise},this.validCallback=null,this.invalidCallback=null,this.reset=function(a){if(void 0===a)return void f.error("This is not a regular Form name scope");if(a.validationId)b.$broadcast(a.$name+"reset-"+a.validationId);else if(a.constructor===Array)for(var c in a)b.$broadcast(a[c].$name+"reset-"+a[c].validationId);else for(var d in a)"$"!==d[0]&&a[d].hasOwnProperty("$dirty")&&b.$broadcast(d+"reset-"+a[d].validationId)},this.$get=["$injector",function(a){return h(a),{setValidMethod:this.setValidMethod,getValidMethod:this.getValidMethod,setErrorHTML:this.setErrorHTML,getErrorHTML:this.getErrorHTML,setSuccessHTML:this.setSuccessHTML,getSuccessHTML:this.getSuccessHTML,setExpression:this.setExpression,getExpression:this.getExpression,setDefaultMsg:this.setDefaultMsg,getDefaultMsg:this.getDefaultMsg,showSuccessMessage:this.showSuccessMessage,showErrorMessage:this.showErrorMessage,checkValid:this.checkValid,validate:this.validate,validCallback:this.validCallback,invalidCallback:this.invalidCallback,reset:this.reset}}]}angular.module("validation.provider").provider("$validation",a)}.call(this),function(){function a(a){var b=a.get("$validation"),c=a.get("$timeout"),d=a.get("$parse");return{link:function(a,e,f){var g=d(f.validationReset)(a);c(function(){e.on("click",function(a){a.preventDefault(),b.reset(g)})})}}}angular.module("validation.directive").directive("validationReset",a),a.$inject=["$injector"]}.call(this),function(){function a(a){var b=a.get("$validation"),c=a.get("$timeout"),d=a.get("$parse");return{priority:1,require:"?ngClick",link:function(a,e,f){var g=d(f.validationSubmit)(a);c(function(){e.off("click"),e.on("click",function(c){c.preventDefault(),b.validate(g).success(function(){d(f.ngClick)(a)})})})}}}angular.module("validation.directive").directive("validationSubmit",a),a.$inject=["$injector"]}.call(this),function(){function a(a){var b=a.get("$validation"),c=a.get("$q"),d=a.get("$timeout"),e=a.get("$parse"),f=a.get("$rootScope"),g=a.get("$log"),h=a.get("validationPromiseUtils"),i=function(a,c,d,f,g,h){var i,j=c||b.getDefaultMsg(d).success,k=e("success");return i=h.messageId?angular.element(document.querySelector("#"+h.messageId)):a.next(),a.attr("no-validation-message")?i.css("display","none"):b.showSuccessMessage&&j?(i.html(b.getSuccessHTML(j)),i.css("display","")):(i.css("display","none"),i.html("")),g.$setValidity(g.$name,!0),k&&k({message:j}),b.validCallback&&b.validCallback(a),!0},j=function(a,c,d,f,g,h){var i,j=c||b.getDefaultMsg(d).error,k=e("error");return i=h.messageId?angular.element(document.querySelector("#"+h.messageId)):a.next(),a.attr("no-validation-message")?i.css("display","none"):b.showErrorMessage&&j?(i.html(b.getErrorHTML(j)),i.css("display","")):i.css("display","none"),g.$setValidity(g.$name,!1),k&&k({message:j}),b.invalidCallback&&b.invalidCallback(a),!1},k={},l=function(a,d,e,f,h,k){var m=h.slice(0),n=m[0].trim(),o=n.indexOf("="),p=-1===o?n:n.substr(0,o),q=-1===o?null:n.substr(o+1),r=m.slice(1),s=p+"SuccessMessage",t=p+"ErrorMessage",u=b.getExpression(p),v={success:function(){return i(d,e[s],p,a,f,e),r.length?l(a,d,e,f,r,k):!0},error:function(){return j(d,e[t],p,a,f,e)}};return void 0===u?(g.error('You are using undefined validator "%s"',p),r.length?l(a,d,e,f,r,k):void 0):u.constructor===Function?c.all([b.getExpression(p)(k,a,d,e,q)]).then(function(a){return a&&a.length>0&&a[0]?v.success():v.error()},function(){return v.error()}):u.constructor===RegExp&&void 0!==k&&null!==k&&b.getExpression(p).test(k)?v.success():v.error()},m=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},n=function(){return m()+m()+m()+m()};return{restrict:"A",require:"ngModel",link:function(a,c,e,g){g.$angularValidators||(g.$angularValidators={}),a.$on("$destroy",function(){g.$angularValidators&&delete g.$angularValidators[g.$name+"submit-"+o]});var i,j=function(){},m=e.validator.split(","),o=g.validationId=n(),p=null;"boolean"==typeof a.initialValidity&&(i=a.initialValidity),e.messageId||c.after("<span></span>"),g.$setValidity(g.$name,i),a.$on(g.$name+"reset-"+o,function(){j(),d(function(){g.$setViewValue(p),g.$setPristine(),g.$setValidity(g.$name,void 0),g.$render(),e.messageId?angular.element(document.querySelector("#"+e.messageId)).html(""):c.next().html(""),b.validCallback&&b.validCallback(c)})});var q=angular.isUndefined(e.validMethod)?b.getValidMethod():e.validMethod;return g.$angularValidators[g.$name+"-"+o]=function(b){f.$broadcast(g.$name+"-"+o,b);var i=g.$viewValue,n=!1;n=l(a,c,e,g,m,i),"submit"===q&&(j(),j=a.$watch(function(){return a.$eval(e.ngModel)},function(b,d){b!==d&&((void 0===b||null===b)&&(b=""),n=l(a,c,e,g,m,b))}));var p=function(a){a?delete k[b]:(k[b]=c[0],d(function(){k[Math.min.apply(null,Object.keys(k))].focus()},0))};return h.toPromise(n).then(function(a){return p(a),a}),n},"blur"===q?void c.bind("blur",function(){var b=a.$eval(e.ngModel);a.$apply(function(){l(a,c,e,g,m,b)})}):void("submit"!==q&&"submit-only"!==q&&(a.$watch(function(){return a.$eval(e.ngModel)},function(b){if(g.$pristine&&g.$viewValue)p=g.$viewValue||"",g.$setViewValue(g.$viewValue);else if(g.$pristine)return void(e.messageId?angular.element(document.querySelector("#"+e.messageId)).html(""):c.next().html(""));l(a,c,e,g,m,b)}),d(function(){e.$observe("noValidationMessage",function(a){var b;b=e.messageId?angular.element(document.querySelector("#"+e.messageId)):c.next(),"true"===a||a===!0?b.css("display","none"):("false"===a||a===!1)&&b.css("display","block")})})))}}}angular.module("validation.directive").directive("validator",a),a.$inject=["$injector"]}.call(this);